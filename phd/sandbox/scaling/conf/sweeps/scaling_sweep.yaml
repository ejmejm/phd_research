program: run_jax_experiment.py
method: grid
project: sandbox-model-scaling
name: width-depth-sparsity-sweep

command:
  - ${env}
  - python
  - ${program}
  - ${args_no_hyphens}

metric:
  name: test/final_test_loss
  goal: maximize

parameters:
  wandb:
    value: true
  
  data.preload:
    value: true
  data.dataset:
    value: mnist

  train.total_samples:
    value: 100000
  
  model.width:
    values: [32, 64, 128, 256, 512, 1024]
  model.depth:
    values: [2, 4, 6]
  
  train.learning_rate:
    values: [0.0005, 0.0001, 0.00005, 0.00001]
  
  # model.sparsity:
  #   values: [0.0, 0.25, 0.5, 0.75, 0.9]


  seed:
    value: 1
