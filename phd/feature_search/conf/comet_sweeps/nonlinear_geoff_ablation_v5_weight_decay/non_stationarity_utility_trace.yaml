name: utility_decay
project: feature_recycling-nlg_ablation_v5_weight_decay
command: python scripts/full_feature_search.py --config-name=comet_sweeps/nonlinear_geoff_ablation_v5/base_config.yaml
algorithm: grid

spec:
  metric: cumulative_loss
  objective: minimize
  retryAssignLimit: 4

parameters:
  task.n_stationary_layers: 0
  model.hidden_dim: 20480

  optimizer.learning_rate: ${eval:0.0003 / ${model.hidden_dim} ** 0.75}
  task.flip_rate: "${eval:2**-12}"
  seed: [501, 502, 503, 504, 505]
  feature_recycling.utility_decay: [0.5, 0.8, 0.9, 0.95, 0.99]
  optimizer.weight_decay: [0.0, 0.1, 0.5, 1.0]
