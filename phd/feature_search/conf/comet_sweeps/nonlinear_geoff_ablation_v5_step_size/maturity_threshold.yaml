# Check if Autostep or CBP is a problem in the non-stationary setting

name: maturity_threshold
project: feature_recycling-nlg_ablation_v5_step_size
command: python scripts/full_feature_search.py --config-name=comet_sweeps/nonlinear_geoff_ablation_v5_step_size/base_config.yaml
algorithm: grid

spec:
  metric: cumulative_loss
  objective: minimize
  retryAssignLimit: 4

parameters:
  train.total_steps: 1_000_000
  train.log_freq: 2000
  task.n_stationary_layers: 0
  model.hidden_dim: 5120
  task.flip_rate: "${eval:2**-16}"
  train.log_optimizer_stats: true
  optimizer.name: idbd
  feature_recycling.utility_reset_mode: zero

  feature_recycling.recycle_rate: ["${eval:2**-14}", "${eval:2**-12}", "${eval:2**-10}", "${eval:2**-8}", "${eval:2**-6}", "${eval:2**-4}"]
  feature_recycling.maturity_threshold: [32, 128, 256, 1024, 4096, 16384]
  optimizer.learning_rate: ["${eval:2**-10}", "${eval:2**-12}", "${eval:2**-14}", "${eval:2**-16}", "${eval:2**-18}", "${eval:2**-20}"]
  optimizer.meta_learning_rate: ["${eval:2**-12}", "${eval:2**-10}", "${eval:2**-8}", "${eval:2**-6}"]
  

  seed: [601, 602, 603]
