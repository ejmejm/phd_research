# Check if Autostep or CBP is a problem in the non-stationary setting

name: ns_baselines
project: feature_recycling-nlg_ablation_v5_step_size
command: python scripts/full_feature_search.py --config-name=comet_sweeps/nonlinear_geoff_ablation_v5_step_size/base_config.yaml
algorithm: grid

spec:
  metric: cumulative_loss
  objective: minimize
  retryAssignLimit: 4

parameters:
  train.total_steps: 1_000_000
  train.log_freq: 2000
  task.n_stationary_layers: 0
  model.hidden_dim: 5120
  task.flip_rate: "${eval:2**-16}"
  train.log_optimizer_stats: true

  optimizer.learning_rate: ["${eval:2**-10}", "${eval:2**-12}", "${eval:2**-14}", "${eval:2**-16}", "${eval:2**-18}", "${eval:2**-20}"]
  
  feature_recycling.recycle_rate: [0.0, 0.005]
  optimizer.name: [sgd, idbd]

  seed: [501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515]
